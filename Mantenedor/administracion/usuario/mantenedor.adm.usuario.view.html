<div class="container"> <div class="custom-menu row"> <div class="columns large-6" style="margin-top:35px"> <ul class="nav nav-tabs nav-justified"> <li class="active"> <a href="#" ui-sref="er.admusuario"><i class="fa fa-file" aria-hidden="true"></i> Usuarios</a> </li> <li class="ng-show" ng-show="user.permisos.listarSolicitudes && user.permisos.listarPerfil"> <a href="#" ui-sref="er.admperfil"><i class="fa fa-folder" aria-hidden="true"></i> Perfiles</a> </li> </ul> </div> </div> <div class="row"> <div class="columns large-12" style="border-bottom:1px solid #ccc"></div> </div> <div class="text-center ng-show" ng-hide="user.permisos.listarUsuario"> <p class="base-font-size">No tiene los permisos necesarios para usar este módulo</p> </div> <div class="ng-show" ng-show="user.permisos.listarUsuario"> <div class="row"> <div class="columns large-4"></div> <div class="columns large-4"></div> <div class="columns large-4"></div> </div> <div class="row"> <div class="columns large-12" style="float:right"> <ul class="button-group btn-left"> <li class="btn-left ng-show" ng-show="user.permisos.crearUsuario" ng-click="adm.editarUsuario.nuevo()"> <button href="#" data-dropdown="drop1" aria-controls="drop1" aria-expanded="false" class="btn btn-warning button dropdown" style="float:left;margin-top:15px;margin-right:10px"> <i class="fa fa-user-plus fa-lg"></i>&nbsp;Crear Usuario</button> </li> </ul> <ul class="nav navbar-nav separacion-top" style="float:right"> <li> <a href="#" ng-click="adm.toggleFarmaco()" onclick="return!1" style="color:#575756!important">Mostrar inactivos&nbsp;<i ng-class="adm.grilla.farmaco.clase" aria-hidden="true"></i></a> </li> <li> <div class="input-group stylish-input-group" style="width:300px;float:right"> <input ng-keypress="adm.grilla.pressEnterSearch($event)" type="text" class="form-control" ng-model="adm.grilla.searchTerms" ng-change="adm.grilla.searchTermsChange()" placeholder="Ingrese nombre del usuario"> <span class="input-group-addon" style="background-color:#fff"> <button class="search-button" ng-click="adm.grilla.search()" type="submit" id="myBtn" style="background-color:#fff;border:none"> <a href="#" onclick="return!1" style="color:#666"> <i class="fa fa-search" aria-hidden="true"></i> </a> </button> </span> </div> </li> </ul> </div> </div> <div class="row"> <div class="table-responsive columns large-12" style="margin-top:20px"> <table class="table grilla"> <thead class="thead-inverse" style="background-color:#00949B"> <tr> <th> Rut <i ng-click="adm.sortRut($event)" class="sorter fa fa-caret-down"></i> </th> <th> Correo <i ng-click="adm.sortCorreo($event)" class="sorter fa fa-caret-down"></i> </th> <th> Nombre Completo <i ng-click="adm.sortNombre($event)" class="sorter fa fa-caret-down"></i> </th> <th> Estado <i ng-click="adm.sortEstado($event)" class="sorter fa fa-caret-down"></i> </th> </tr> </thead> <tbody> <tr class="loading"> <td class="grilla-vacia ng-hide" colspan="{{adm.grilla.largo}}" ng-show="adm.grilla.waiting"> <i class="fa fa-4x fa-spinner fast-spin"></i> </td> </tr> <tr> <td class="grilla-sin-resultado ng-hide" colspan="{{adm.grilla.largo}}" ng-show="adm.grilla.sinResultado"> <p>No se encontraron usuarios</p> </td> </tr> <tr id="" ng-repeat="usuario in adm.grilla.resultado track by usuario.Id"> <th>{{usuario.Rut}}</th> <td>{{usuario.Email}}</td> <td class="">{{usuario.FullName}} </td> <td class="large-4"> <div class="botonera-grid"> <button ng-show="user.permisos.modificarUsuario" ng-click="adm.editarUsuario.editar($index)" class="btn btn-warning">Editar</button> <button ng-click="adm.detalleUsuario.viewUser($index)" class="btn btn-warning">Ver</button> <button ng-show="user.permisos.desactivarUsuario" ng-click="adm.modalDesactivacion.show(usuario, !usuario.Locked)" class="btn btn-warning">{{(usuario.Locked)? 'ACTIVAR':'INACTIVAR'}}</button> <span ng-show="!user.permisos.desactivarUsuario" class="">{{(usuario.Locked)? 'ACTIVO':'INACTIVO'}}</span> </div> </td> </tr> </tbody> </table> </div> </div> <div class="columns large-12"> <div class="columns large-4"></div> <div class="columns large-4"></div> <div class="columns large-4"> <div class="row"> <div class="botonera-drop btn-right"> <button href="#" data-dropdown="gridCounter" aria-controls="gridCounter" aria-expanded="false" class="btn btn-default button dropdown" style="float:left;margin-top:15px;margin-right:10px"> Mostrar {{adm.grilla.mostrando}} </button> <ul id="gridCounter" data-dropdown-content class="f-dropdown" aria-hidden="true"> <li><a href="#" onclick="return!1" ng-click="adm.grilla.cambiarContador(10)">Mostrar 10</a></li> <li><a href="#" onclick="return!1" ng-click="adm.grilla.cambiarContador(15)">Mostrar 15</a></li> <li><a href="#" onclick="return!1" ng-click="adm.grilla.cambiarContador(20)">Mostrar 20</a></li> <li><a href="#" onclick="return!1" ng-click="adm.grilla.cambiarContador(25)">Mostrar 25</a></li> <li role="separator" class="divider"></li> <li><a href="#" onclick="return!1" ng-click="adm.grilla.cambiarContador(30)">Mostrar 30</a></li> </ul> </div> </div> </div> </div> <div class="row columns large-12"> <div class="columns large-4">&nbsp;</div> <div class="columns large-4"> <nav aria-label="Page navigation"> <ul class="pagination"> <li> <a href="#" ng-click="adm.grilla.anteriorPagina()" onclick="return!1" aria-label="Previous"> <span aria-hidden="true">&laquo;</span> </a> </li> <li ng-class="(adm.grilla.paginaActual == page)? 'current':'' " ng-repeat="page in adm.grilla.paginacion.labels" ng-click="adm.grilla.muestraPagina(page)"> <a href="#" onclick="return!1">{{page}}</a> </li> <li> <a href="#" ng-click="adm.grilla.siguientePagina()" onclick="return!1" aria-label="Next"> <span aria-hidden="true">&raquo;</span> </a> </li> </ul> </nav> </div> <div class="columns large-4">&nbsp;</div> </div> </div> </div> <div id="editarUsuario" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog" data-options="close_on_background_click:false;close_on_esc:false;"> <div class="modal-header"> <button class="close-reveal-modal" ng-disabled="adm.editarUsuario.procesando" ng-click="adm.editarUsuario.cancelar()" aria-label="Close" type="button">&times;</button> <h4 class="modal-title"> &nbsp;&nbsp;{{adm.editarUsuario.titulo}} </h4> </div> <div class="modal-body large-12"> <div class="row ng-show" ng-show="adm.editarUsuario.esEdicion"> <div class="large-4 columns inputs-modal text-right">RUT*:</div> <div class="large-8 columns inputs-modal"> {{adm.editarUsuario.form.rut}} </div> </div> <div class="row ng-show" ng-show="!adm.editarUsuario.esEdicion"> <div class="large-4 columns inputs-modal text-right">RUT*:</div> <div class="large-8 columns inputs-modal"> <input type="text" class="form-control" ng-disabled="adm.editarUsuario.procesando" ng-change="adm.editarUsuario.validarFormatoRut()" ng-disabled="adm.editarUsuario.procesando" ng-model="adm.editarUsuario.form.rut" placeholder="Rut del usuario"> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.rut" role="alert"> <strong>REQUERIDO</strong> </div> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.rutInvalido" role="alert"> <strong>Formato de rut Invalido</strong> </div> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.rutDuplicado" role="alert"> <strong>Este rut ya se encuentra registrado</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Nombre*:</div> <div class="large-8 columns inputs-modal"> <input type="text" class="form-control" ng-disabled="adm.editarUsuario.procesando" ng-model="adm.editarUsuario.form.nombre" placeholder="Ingrese el nombre completo"> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.nombre" role="alert"><strong>REQUERIDO</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Correo*:</div> <div class="large-8 columns inputs-modal"> <input type="text" class="form-control" ng-disabled="adm.editarUsuario.procesando" ng-model="adm.editarUsuario.form.correo" placeholder="nombre@correo.cl"> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.correo" role="alert"><strong>REQUERIDO</strong> </div> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.correoDuplicado" role="alert"> <strong>Este correo ya se encuentra registrado</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Perfiles*:</div> <div class="large-8 columns inputs-modal"> <i class="fa fa-spinner fast-spin ng-show" ng-show="adm.editarUsuario.loading.perfiles"></i> <div class="ng-show" ng-show="!adm.editarUsuario.loading.perfiles"> <div class="list-historial columns" style="padding:0"> <div ng-repeat="perfil in adm.editarUsuario.form.perfiles" class="large-6 btn-left"> <div> <input type="checkbox" ng-change="adm.editarUsuario.recargarPermisosIndividuales(perfil)" id="perfil-{{perfil.Name}}" ng-model="perfil.checked" ng-disabled="adm.editarUsuario.procesando || (perfil.Name == 'Administrador' && user.data.Roles.indexOf('Administrador') == -1)"> <label style="float:none" for="perfil-{{perfil.Name}}">&nbsp;&nbsp;{{perfil.Name}}</label> </div> </div> </div> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.perfiles" role="alert"><strong>REQUERIDO</strong> </div> </div> <div class="alert alert-danger ng-show" ng-show="adm.editarUsuario.requerido.factor" role="alert"><strong>REQUERIDO</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Permisos a Excluir :</div> <div class="large-8 columns inputs-modal"> <select ng-model="adm.editarUsuario.select.excluirPermiso" ng-change="adm.editarUsuario.excluirPermiso()" ng-disabled="adm.editarUsuario.procesando" ng-options="permiso for permiso in adm.editarUsuario.permisos.excluir track by permiso"> <option value="">Elija los permisos a excluir</option> </select> <div> <div class="text-lista"> <table class="large-12 ng-show" ng-show="adm.editarUsuario.form.permisosExcluidos.length == 0"> <tr> <td>N/A</td> </tr> </table> <table class="large-12 ng-show" ng-show="adm.editarUsuario.form.permisosExcluidos.length > 0"> <tr ng-repeat="permiso in adm.editarUsuario.form.permisosExcluidos"> <td>{{permiso}}<span ng-click="adm.editarUsuario.quitarExclusion(permiso)" class="btn-right btn-quitar">[x]</span></td> </tr> </table> </div> </div> <div class="alert alert-danger ng-show" ng-show="adm.editarUsuario.requerido.factor" role="alert"><strong>REQUERIDO</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Permisos a Incluir :</div> <div class="large-8 columns inputs-modal"> <select ng-model="adm.editarUsuario.select.incluirPermiso" ng-change="adm.editarUsuario.incluirPermiso()" ng-disabled="adm.editarUsuario.procesando" ng-options="permiso for permiso in adm.editarUsuario.permisos.incluir track by permiso"> <option value="">Elija los permisos a incluir</option> </select> <div> <div class="text-lista"> <table class="large-12 ng-show" ng-show="adm.editarUsuario.form.permisosIncluidos.length == 0"> <tr> <td>N/A</td> </tr> </table> <table class="large-12 ng-show" ng-show="adm.editarUsuario.form.permisosIncluidos.length > 0"> <tr ng-repeat="permiso in adm.editarUsuario.form.permisosIncluidos"> <td>{{permiso}}<span ng-click="adm.editarUsuario.quitarInclusion(permiso)" class="btn-right btn-quitar">[x]</span></td> </tr> </table> </div> </div> <div class="alert alert-danger ng-show" ng-show="adm.editarUsuario.requerido.factor" role="alert"><strong>REQUERIDO</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Establecimientos Asignados :</div> <div class="large-8 columns inputs-modal ng-show" ng-show="adm.editarUsuario.loading.nodos"> <i class="fa fa-spinner fast-spin"></i> </div> <div class="large-8 columns inputs-modal ng-show" ng-show="!adm.editarUsuario.loading.nodos"> <select ng-model="adm.editarUsuario.form.servicio" ng-change="adm.editarUsuario.seleccionarServicio()" ng-disabled="adm.editarUsuario.procesando" ng-options="servicio.DESCRIPCION for servicio in adm.editarUsuario.listas.servicios track by servicio.ID"> <option value="todos">Todos los Servicios</option> </select> <div class="form-control ng-show" ng-show="adm.editarUsuario.loading.comunas"> <i class="fa fa-spinner fast-spin"></i> </div> <select class="ng-show" ng-show="adm.editarUsuario.listas.comunas.length > 0" ng-model="adm.editarUsuario.form.comuna" ng-change="adm.editarUsuario.seleccionarComuna()" ng-disabled="adm.editarUsuario.procesando" ng-options="comuna.name for comuna in adm.editarUsuario.listas.comunas track by comuna.value"> <option>Todas las Comunas</option> </select> <div class="form-control ng-show" ng-show="adm.editarUsuario.loading.establecimientos"> <i class="fa fa-spinner fast-spin"></i> </div> <select class="ng-show" ng-show="adm.editarUsuario.listas.nodos.length > 0" ng-model="adm.editarUsuario.form.establecimiento" ng-disabled="adm.editarUsuario.procesando" ng-options="nodo.name for nodo in adm.editarUsuario.listas.nodos track by nodo.value"> <option>Todos los Establecimientos</option> </select> <div> <div> <table class="large-12"> <tr ng-repeat="nodo in adm.editarUsuario.form.nodos"> <td data-td="{{nodo}}">{{nodo.DESCRIPCION}}<span ng-click="adm.editarUsuario.quitarNodo(nodo)" class="btn-right btn-quitar">[x]</span></td> </tr> </table> </div> </div> <div class="alert alert-danger ng-show" ng-show="adm.editarUsuario.requerido.nodos" role="alert"><strong>REQUERIDO</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Contraseña*:<br></div> <div class="large-8 columns inputs-modal"> <input type="password" class="form-control" ng-model="adm.editarUsuario.form.clave" placeholder="********"> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.clave" role="alert"><strong>Requerido</strong> </div> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.claveDistinta" role="alert"><strong>Las claves deben coincidir</strong> </div> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.claveFormato" role="alert"><strong>La contraseña no cumple los requisitos de formato</strong> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Repita la contraseña*:</div> <div class="large-8 columns inputs-modal"> <input type="password" class="form-control" ng-model="adm.editarUsuario.form.repitaClave" placeholder="********"> <div><i style="font-size:12px">El formato aceptado es: Largo 8 con al menos 2 mayúsculas, 2 minúsculas y 2 dígitos y un carácter especial ($, #, @, !, ^)</i></div> <div class="alert alert-danger upcase ng-show" ng-show="adm.editarUsuario.requerido.claveDistinta" role="alert"><strong>Las claves deben coincidir</strong> </div> </div> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-left btn-warning upcase ng-show" ng-show="adm.editarUsuario.esEdicion" ng-disabled="adm.editarUsuario.procesando" ng-click="adm.editarUsuario.guardar()">Guardar</button> <button type="button" class="btn btn-left btn-warning upcase ng-show" ng-show="!adm.editarUsuario.esEdicion" ng-disabled="adm.editarUsuario.procesando" ng-click="adm.editarUsuario.preCrear()">Crear</button> <span class="btn-left ng-show" ng-show="adm.editarUsuario.procesando"><i class="fa fa-spinner fast-spin"></i> {{adm.editarUsuario.textoProcesando}}</span> <button type="button" class="btn btn-danger upcase" ng-disabled="adm.editarUsuario.procesando" ng-click="adm.editarUsuario.cerrar()">Cerrar</button> </div> </div> <div id="detalleUsuario" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog" data-options="close_on_background_click:false;close_on_esc:false;"> <div class="modal-header"> <button class="close-reveal-modal" ng-click="adm.detalleUsuario.cancelar()" aria-label="Close" type="button">&times;</button> <h4 class="modal-title"> &nbsp;&nbsp;{{adm.detalleUsuario.titulo}} </h4> </div> <div class="modal-body large-12"> <div class="row"> <div class="large-4 columns inputs-modal text-right">Nombre*:</div> <div class="large-8 columns inputs-modal"> {{adm.detalleUsuario.form.nombre}} </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">RUT*:</div> <div class="large-8 columns inputs-modal"> {{adm.detalleUsuario.form.rut}} </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Correo*:</div> <div class="large-8 columns inputs-modal"> {{adm.detalleUsuario.form.correo}} </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Perfiles :</div> <div class="large-8 columns inputs-modal ng-show" ng-show="adm.detalleUsuario.loadingPerfiles"> <i class="fa fa-spinner fast-spin"></i> </div> <div class="large-8 columns inputs-modal ng-show" ng-show="!adm.detalleUsuario.loadingPerfiles"> <div class="list-historial columns" style="padding:0"> <div ng-repeat="perfil in adm.detalleUsuario.form.perfiles" class="large-6 btn-left"> <div> <input type="checkbox" ng-change="adm.editarUsuario.recargarPermisosIndividuales(perfil)" id="perfil-{{perfil.Name}}" ng-model="perfil.checked" disabled> <label style="float:none" for="perfil-{{perfil.Name}}">&nbsp;&nbsp;{{perfil.Name}}</label> </div> </div> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Permisos a Excluir :</div> <div class="large-8 columns inputs-modal"> <div> <div class="text-lista"> <table class="large-12 ng-show" ng-show="adm.detalleUsuario.form.permisosExcluidos.length == 0"> <tr> <td>N/A</td> </tr> </table> <table class="large-12 ng-show" ng-show="adm.detalleUsuario.form.permisosExcluidos.length > 0"> <tr ng-repeat="permiso in adm.detalleUsuario.form.permisosExcluidos"> <td>{{permiso}}</td> </tr> </table> </div> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Permisos a Incluir :</div> <div class="large-8 columns inputs-modal"> <div> <div class="text-lista"> <table class="large-12 ng-show" ng-show="adm.detalleUsuario.form.permisosIncluidos.length == 0"> <tr> <td>N/A</td> </tr> </table> <table class="large-12 ng-show" ng-show="adm.detalleUsuario.form.permisosIncluidos.length > 0"> <tr ng-repeat="permiso in adm.detalleUsuario.form.permisosIncluidos"> <td>{{permiso}}</td> </tr> </table> </div> </div> </div> </div> <div class="row"> <div class="large-4 columns inputs-modal text-right">Establecimientos Asignados :</div> <div class="large-8 columns inputs-modal ng-show" ng-show="adm.detalleUsuario.loading"> <i class="fa fa-spinner fast-spin"></i> </div> <div class="large-8 columns inputs-modal ng-show" ng-show="adm.detalleUsuario.form.nodos.length == 0"> <div> <div class="ng-show" ng-show="!adm.detalleUsuario.loading"> <table class="large-12"> <tr> <td data-td="">N/A</td> </tr> </table> </div> </div> </div> <div class="large-8 columns inputs-modal ng-show" ng-show="adm.detalleUsuario.form.nodos.length > 0"> <div> <div class="ng-show" ng-show="!adm.detalleUsuario.loading"> <table class="large-12"> <tr ng-repeat="nodo in adm.detalleUsuario.form.nodos"> <td data-td="{{nodo}}">{{nodo.DESCRIPCION}}</td> </tr> </table> </div> </div> </div> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-danger upcase" ng-click="adm.detalleUsuario.cerrar()">Cerrar</button> </div> </div> <div id="confirmaDesactivacion" class="reveal-modal small" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog" data-options="close_on_background_click:false;close_on_esc:false;"> <div class="modal-header"> <button ng-click="adm.modalDesactivacion.cerrar();" class="close-reveal-modal" aria-label="Close" type="button">&times;</button> <h4 class="modal-title">Confirmar Modificación</h4> </div> <div class="modal-body"> <p class="text-center">¿ Esta seguro de querer <strong class="upcase">{{adm.modalDesactivacion.accion}}</strong> al usuario "{{adm.modalDesactivacion.objeto.FullName}}" ?</p> </div> <div class="modal-footer"> <button ng-disabled="adm.modalDesactivacion.procesando" ng-click="adm.modalDesactivacion.confirmar();" class="btn btn-default upcase">Confirmar</button> <button ng-disabled="adm.modalDesactivacion.procesando" ng-click="adm.modalDesactivacion.cerrar();" class="btn btn-danger upcase" aria-label="Close" aria-hidden="true">Cancelar</button> </div> </div>